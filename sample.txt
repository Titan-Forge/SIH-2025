import sqlite3

# Create or connect to the database
conn = sqlite3.connect("sih.db")
cursor = conn.cursor()

# SQL script to set up tables and insert sample data
sql_script = """
DROP TABLE IF EXISTS timetable;
DROP TABLE IF EXISTS subjects;
DROP TABLE IF EXISTS teachers;
DROP TABLE IF EXISTS users;
DROP TABLE IF EXISTS timetable2;
DROP TABLE IF EXISTS rooms;
DROP TABLE IF EXISTS timetable3;

CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL
);

CREATE TABLE subjects (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL
);

CREATE TABLE timetable (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    slot TEXT,
    subject_id INTEGER,
    teacher_id INTEGER
);

CREATE TABLE teachers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL
);

CREATE TABLE subjectsx (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    teacher_id INTEGER,
    FOREIGN KEY(teacher_id)
    REFERENCES teachers(id)
);

CREATE TABLE timetablex (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    slot TEXT NOT NULL,
    subject_id INTEGER,
    teacher_id INTEGER,
    FOREIGN KEY(subject_id)
    REFERENCES subjects(id),
    FOREIGN KEY(teacher_id)
    REFERENCES teachers(id)
);

INSERT INTO teachers (name) VALUES ('Mr. Sharma'), ('Ms. Gupta');
INSERT INTO subjects (name) VALUES ('Maths'), ('Science');

INSERT INTO timetable (slot, subject_id, teacher_id) VALUES ('Period1', 1, 1);
INSERT INTO timetable (slot, subject_id, teacher_id) VALUES ('Period 2', 2, 2);

CREATE TABLE IF NOT EXISTS teachers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS rooms (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS timetable3 (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    run_id TEXT,
    slot TEXT,
    subject TEXT,
    teacher TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO teachers (name) VALUES ('Mr. Sharma'), ('Ms. Gupta');
INSERT INTO subjects (name) VALUES ('Maths'), ('Physics');

INSERT INTO rooms (name) VALUES ('Lab1'), ('Room401');
"""

# Execute SQL script
cursor.executescript(sql_script)

# Save changes and close the connection
conn.commit()
conn.close()

print("âœ… sih.db created successfully with sample data.")
